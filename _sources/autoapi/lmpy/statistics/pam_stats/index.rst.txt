:py:mod:`lmpy.statistics.pam_stats`
===================================

.. py:module:: lmpy.statistics.pam_stats

.. autoapi-nested-parse::

   Module containing base PAM statistic functionality.



Module Contents
---------------

Classes
~~~~~~~

.. autoapisummary::

   lmpy.statistics.pam_stats.CovarianceMatrixMetric
   lmpy.statistics.pam_stats.DiversityMetric
   lmpy.statistics.pam_stats.PamDistMatrixMetric
   lmpy.statistics.pam_stats.PamStats
   lmpy.statistics.pam_stats.PamStatsMetric
   lmpy.statistics.pam_stats.SiteMatrixMetric
   lmpy.statistics.pam_stats.SpeciesMatrixMetric
   lmpy.statistics.pam_stats.TreeDistanceMatrixMetric
   lmpy.statistics.pam_stats.TreeMetric



Functions
~~~~~~~~~

.. autoapisummary::

   lmpy.statistics.pam_stats.alpha
   lmpy.statistics.pam_stats.alpha_proportional
   lmpy.statistics.pam_stats.c_score
   lmpy.statistics.pam_stats.lande
   lmpy.statistics.pam_stats.legendre
   lmpy.statistics.pam_stats.mean_nearest_taxon_distance
   lmpy.statistics.pam_stats.mean_pairwise_distance
   lmpy.statistics.pam_stats.num_sites
   lmpy.statistics.pam_stats.num_species
   lmpy.statistics.pam_stats.omega
   lmpy.statistics.pam_stats.omega_proportional
   lmpy.statistics.pam_stats.pearson_correlation
   lmpy.statistics.pam_stats.phi
   lmpy.statistics.pam_stats.phi_average_proportional
   lmpy.statistics.pam_stats.phylogenetic_diversity
   lmpy.statistics.pam_stats.psi
   lmpy.statistics.pam_stats.psi_average_proportional
   lmpy.statistics.pam_stats.schluter_site_variance_ratio
   lmpy.statistics.pam_stats.schluter_species_variance_ratio
   lmpy.statistics.pam_stats.sigma_sites
   lmpy.statistics.pam_stats.sigma_species
   lmpy.statistics.pam_stats.sum_pairwise_distance
   lmpy.statistics.pam_stats.whittaker



.. py:class:: CovarianceMatrixMetric(func)

   Bases: :py:obj:`PamStatsMetric`

   Constructor.

   :param func: The function to call.


.. py:class:: DiversityMetric(func)

   Bases: :py:obj:`PamStatsMetric`

   Constructor.

   :param func: The function to call.


.. py:class:: PamDistMatrixMetric(func)

   Bases: :py:obj:`_SiteStatMetric`

   Constructor.

   :param func: The function to call.


.. py:class:: PamStats(pam, tree=None, tree_matrix=None, node_heights_matrix=None, tip_lengths_matrix=None, logger=None)

   Constructor for PAM stats computations.

   :param pam: A presence-absence matrix to use for computations.
   :type pam: Matrix
   :param tree: A tree to use for phylogenetic distance computations.
   :type tree: TreeWrapper
   :param tree_matrix: A matrix of tip / node presence absence values.
   :type tree_matrix: Matrix
   :param node_heights_matrix: A matrix of node height values.
   :type node_heights_matrix: Matrix
   :param tip_lengths_matrix: A matrix of tip length values.
   :type tip_lengths_matrix: Matrix
   :param logger: An optional local logger to use for logging output
                  with consistent options
   :type logger: lmpy.log.Logger

   .. py:attribute:: covariance_stats
      :annotation: = [None, None]

      

   .. py:attribute:: diversity_stats
      :annotation: = [None, None, None, None, None, None]

      

   .. py:attribute:: site_matrix_stats
      :annotation: = [None, None, None, None]

      

   .. py:attribute:: site_pam_dist_mtx_stats
      :annotation: = [None]

      

   .. py:attribute:: site_tree_distance_matrix_stats
      :annotation: = [None, None, None]

      

   .. py:attribute:: site_tree_stats
      :annotation: = [None]

      

   .. py:attribute:: species_matrix_stats
      :annotation: = [None, None, None, None]

      

   .. py:method:: calculate_covariance_statistics()

      Calculate covariance statistics matrices.

      :returns: A list of metric name, value tuples for covariance stats.
      :rtype: list of tuple


   .. py:method:: calculate_diversity_statistics()

      Calculate diversity statistics.

      :returns: A list of metric name, value tuples for diversity metrics.
      :rtype: list of tuple


   .. py:method:: calculate_site_statistics()

      Calculate site-based statistics.

      :returns: A matrix of site-based statistics for the selected metrics.
      :rtype: Matrix


   .. py:method:: calculate_species_statistics()

      Calculate species-based statistics.

      :returns: A matrix of species-based statistics for the selected metrics.
      :rtype: Matrix


   .. py:method:: register_metric(name, metric_function)

      Register a new metric.

      :param name: A name for this metric that will be used for a header.
      :type name: str
      :param metric_function: A decorated metric generating function.
      :type metric_function: function

      :raises TypeError: Raised if the metric function type cannot be processed.



.. py:class:: PamStatsMetric(func)

   Constructor.

   :param func: The function to call.

   .. py:method:: __call__(*args, **kwargs)

      Call the wrapped function.

      :param \*args: Positional arguments passed to the function.
      :param \*\*kwargs: Keyword arguments passed to the function.

      :returns: The output of the wrapped function.
      :rtype: object



.. py:class:: SiteMatrixMetric(func)

   Bases: :py:obj:`_SiteStatMetric`

   Constructor.

   :param func: The function to call.


.. py:class:: SpeciesMatrixMetric(func)

   Bases: :py:obj:`_SpeciesStatMetric`

   Constructor.

   :param func: The function to call.


.. py:class:: TreeDistanceMatrixMetric(func)

   Bases: :py:obj:`_SiteStatMetric`

   Constructor.

   :param func: The function to call.


.. py:class:: TreeMetric(func)

   Bases: :py:obj:`_SiteStatMetric`

   Constructor.

   :param func: The function to call.


.. py:function:: alpha(pam)

   Calculate alpha diversity, the number of species in each site.

   :param pam: The presence-absence matrix to use for the computation.
   :type pam: Matrix

   :returns: A column of alpha diversity values for each site in the PAM.
   :rtype: Matrix


.. py:function:: alpha_proportional(pam)

   Calculate proportional alpha diversity.

   :param pam: The presence-absence matrix to use for the computation.
   :type pam: Matrix

   :returns:

             A column of proportional alpha diversity values for each site in the
                 PAM.
   :rtype: Matrix


.. py:function:: c_score(pam)

   Calculate the checker board score for the PAM.

   :param pam: The presence-absence matrix to use for the computation.
   :type pam: Matrix

   :returns: The checkerboard score for the PAM.
   :rtype: float


.. py:function:: lande(pam)

   Calculate Lande's beta diversity metric for a PAM.

   :param pam: The presence-absence matrix to use for the computation.
   :type pam: Matrix

   :returns: Lande's beta diversity for the PAM.
   :rtype: float


.. py:function:: legendre(pam)

   Calculate Legendre's beta diversity metric for a PAM.

   :param pam: The presence-absence matrix to use for the computation.
   :type pam: Matrix

   :returns: Legendre's beta diversity for the PAM.
   :rtype: float


.. py:function:: mean_nearest_taxon_distance(phylo_dist_mtx)

   Calculates the nearest neighbor distance.

   :param phylo_dist_mtx: A matrix of distances between the species present at a
                          site.
   :type phylo_dist_mtx: Matrix

   :returns: The average distance from each taxa to taxa nearest to it.
   :rtype: float


.. py:function:: mean_pairwise_distance(phylo_dist_mtx)

   Calculates mean pairwise distance between species present at a site.

   :param phylo_dist_mtx: A matrix of distances between the species present at a
                          site.
   :type phylo_dist_mtx: Matrix

   :returns: The average distance from each taxa all of the other co-located taxa.
   :rtype: float


.. py:function:: num_sites(pam)

   Get the number of sites with presences.

   :param pam: The presence-absence matrix to use for the computation.
   :type pam: Matrix

   :returns: The number of sites that have present species.
   :rtype: int


.. py:function:: num_species(pam)

   Get the number of species with presences.

   :param pam: The presence-absence matrix to use for the computation.
   :type pam: Matrix

   :returns: The number of species that are present in at least one site.
   :rtype: int


.. py:function:: omega(pam)

   Calculate the range size per species.

   :param pam: The presence-absence matrix to use for the computation.
   :type pam: Matrix

   :returns: A row of range sizes for each species in the PAM.
   :rtype: Matrix


.. py:function:: omega_proportional(pam)

   Calculate the mean proportional range size of each species.

   :param pam: The presence-absence matrix to use for the computation.
   :type pam: Matrix

   :returns: A row of the proportional range sizes for each species in the PAM.
   :rtype: Matrix


.. py:function:: pearson_correlation(pam, phylo_dist_mtx)

   Calculates the Pearson correlation coefficient for each site.

   :param pam: A presence-absence matrix to use for the computation.
   :type pam: Matrix
   :param phylo_dist_mtx: A matrix of distance between species.
   :type phylo_dist_mtx: Matrix

   :returns: A column of Pearson correlation values for each site in a PAM.
   :rtype: Matrix


.. py:function:: phi(pam)

   Calculate phi, the range size per site.

   :param pam: The presence-absence matrix to use for the computation.
   :type pam: Matrix

   :returns:

             A column of the sum of the range sizes for the species present at each
                 site in the PAM.
   :rtype: Matrix


.. py:function:: phi_average_proportional(pam)

   Calculate proportional range size per site.

   :param pam: The presence-absence matrix to use for the computation.
   :type pam: Matrix

   :returns:

             A column of the proportional value of the sum of the range sizes for
                 the species present at each site in the PAM.
   :rtype: Matrix


.. py:function:: phylogenetic_diversity(tree)

   Calculate phylogenetic diversity of a tree.

   :param tree: A phylogenetic tree to compute phylogenetic diversity for.
   :type tree: TreeWrapper

   :returns: The sum of the edge lengths of the nodes of the provided tree.
   :rtype: float


.. py:function:: psi(pam)

   Calculate the range richness of each species.

   :param pam: The presence-absence matrix to use for the computation.
   :type pam: Matrix

   :returns: A row of range richness for the sites that each species is present in.
   :rtype: Matrix


.. py:function:: psi_average_proportional(pam)

   Calculate the mean proportional species diversity.

   :param pam: The presence-absence matrix to use for the computation.
   :type pam: Matrix

   :returns:

             A row of proportional range richness for the sites that each species in
                 the PAM is present.
   :rtype: Matrix


.. py:function:: schluter_site_variance_ratio(pam)

   Calculate Schluter's site variance ratio.

   :param pam: The presence-absence matrix to use for the computation.
   :type pam: Matrix

   :returns: The Schluter site variance ratio for the PAM.
   :rtype: float


.. py:function:: schluter_species_variance_ratio(pam)

   Calculate Schluter's species variance ratio.

   :param pam: The presence-absence matrix to use for the computation.
   :type pam: Matrix

   :returns: The Schluter species variance ratio for the PAM.
   :rtype: float


.. py:function:: sigma_sites(pam)

   Compute the site sigma metric for a PAM.

   :param pam: The presence-absence matrix to use for the computation.
   :type pam: Matrix

   :returns: Matrix of covariance of composition of sites.
   :rtype: Matrix


.. py:function:: sigma_species(pam)

   Compute the species sigma metric for a PAM.

   :param pam: The presence-absence matrix to use for the computation.
   :type pam: Matrix

   :returns: Matrix of covariance of composition of species.
   :rtype: Matrix


.. py:function:: sum_pairwise_distance(phylo_dist_mtx)

   Calculates the sum pairwise distance for all species present at a site.

   :param phylo_dist_mtx: A matrix of distances between the species present at a
                          site.
   :type phylo_dist_mtx: Matrix

   :returns: The total distance from each taxa all of the other co-located taxa.
   :rtype: float


.. py:function:: whittaker(pam)

   Calculate Whittaker's beta diversity metric for a PAM.

   :param pam: The presence-absence matrix to use for the computation.
   :type pam: Matrix

   :returns: Whittaker's beta diversity for the PAM.
   :rtype: float


