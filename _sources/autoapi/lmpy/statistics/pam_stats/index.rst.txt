:mod:`lmpy.statistics.pam_stats`
================================

.. py:module:: lmpy.statistics.pam_stats

.. autoapi-nested-parse::

   Module containing base PAM statistic functionality.



Module Contents
---------------

Classes
~~~~~~~

.. autoapisummary::

   lmpy.statistics.pam_stats.PamStatsMetric
   lmpy.statistics.pam_stats.CovarianceMatrixMetric
   lmpy.statistics.pam_stats.DiversityMetric
   lmpy.statistics.pam_stats.SpeciesMatrixMetric
   lmpy.statistics.pam_stats.SiteMatrixMetric
   lmpy.statistics.pam_stats.PamDistMatrixMetric
   lmpy.statistics.pam_stats.TreeMetric
   lmpy.statistics.pam_stats.TreeDistanceMatrixMetric
   lmpy.statistics.pam_stats.PamStats



Functions
~~~~~~~~~

.. autoapisummary::

   lmpy.statistics.pam_stats.alpha
   lmpy.statistics.pam_stats.alpha_proportional
   lmpy.statistics.pam_stats.phi
   lmpy.statistics.pam_stats.phi_average_proportional
   lmpy.statistics.pam_stats.omega
   lmpy.statistics.pam_stats.omega_proportional
   lmpy.statistics.pam_stats.psi
   lmpy.statistics.pam_stats.psi_average_proportional
   lmpy.statistics.pam_stats.schluter_species_variance_ratio
   lmpy.statistics.pam_stats.schluter_site_variance_ratio
   lmpy.statistics.pam_stats.num_sites
   lmpy.statistics.pam_stats.num_species
   lmpy.statistics.pam_stats.whittaker
   lmpy.statistics.pam_stats.lande
   lmpy.statistics.pam_stats.legendre
   lmpy.statistics.pam_stats.c_score
   lmpy.statistics.pam_stats.sigma_sites
   lmpy.statistics.pam_stats.sigma_species
   lmpy.statistics.pam_stats.mean_nearest_taxon_distance
   lmpy.statistics.pam_stats.mean_pairwise_distance
   lmpy.statistics.pam_stats.sum_pairwise_distance
   lmpy.statistics.pam_stats.pearson_correlation
   lmpy.statistics.pam_stats.phylogenetic_diversity



.. class:: PamStatsMetric(func)


   Constructor.

   :param func: The function to call.

   .. method:: __call__(self, *args, **kwargs)

      Call the wrapped function.

      :param \*args: Positional arguments passed to the function.
      :param \*\*kwargs: Keyword arguments passed to the function.

      :returns: The output of the wrapped function.
      :rtype: object



.. class:: CovarianceMatrixMetric(func)


   Bases: :py:obj:`PamStatsMetric`

   Constructor.

   :param func: The function to call.


.. class:: DiversityMetric(func)


   Bases: :py:obj:`PamStatsMetric`

   Constructor.

   :param func: The function to call.


.. class:: SpeciesMatrixMetric(func)


   Bases: :py:obj:`_SpeciesStatMetric`

   Constructor.

   :param func: The function to call.


.. class:: SiteMatrixMetric(func)


   Bases: :py:obj:`_SiteStatMetric`

   Constructor.

   :param func: The function to call.


.. class:: PamDistMatrixMetric(func)


   Bases: :py:obj:`_SiteStatMetric`

   Constructor.

   :param func: The function to call.


.. class:: TreeMetric(func)


   Bases: :py:obj:`_SiteStatMetric`

   Constructor.

   :param func: The function to call.


.. class:: TreeDistanceMatrixMetric(func)


   Bases: :py:obj:`_SiteStatMetric`

   Constructor.

   :param func: The function to call.


.. function:: alpha(pam)

   Calculate alpha diversity, the number of species in each site.

   :param pam: The presence-absence matrix to use for the computation.
   :type pam: Matrix

   :returns: A column of alpha diversity values for each site in the PAM.
   :rtype: Matrix


.. function:: alpha_proportional(pam)

   Calculate proportional alpha diversity.

   :param pam: The presence-absence matrix to use for the computation.
   :type pam: Matrix

   :returns:

             A column of proportional alpha diversity values for each site in the
                 PAM.
   :rtype: Matrix


.. function:: phi(pam)

   Calculate phi, the range size per site.

   :param pam: The presence-absence matrix to use for the computation.
   :type pam: Matrix

   :returns:

             A column of the sum of the range sizes for the species present at each
                 site in the PAM.
   :rtype: Matrix


.. function:: phi_average_proportional(pam)

   Calculate proportional range size per site.

   :param pam: The presence-absence matrix to use for the computation.
   :type pam: Matrix

   :returns:

             A column of the proportional value of the sum of the range sizes for
                 the species present at each site in the PAM.
   :rtype: Matrix


.. function:: omega(pam)

   Calculate the range size per species.

   :param pam: The presence-absence matrix to use for the computation.
   :type pam: Matrix

   :returns: A row of range sizes for each species in the PAM.
   :rtype: Matrix


.. function:: omega_proportional(pam)

   Calculate the mean proportional range size of each species.

   :param pam: The presence-absence matrix to use for the computation.
   :type pam: Matrix

   :returns: A row of the proportional range sizes for each species in the PAM.
   :rtype: Matrix


.. function:: psi(pam)

   Calculate the range richness of each species.

   :param pam: The presence-absence matrix to use for the computation.
   :type pam: Matrix

   :returns: A row of range richness for the sites that each species is present in.
   :rtype: Matrix


.. function:: psi_average_proportional(pam)

   Calculate the mean proportional species diversity.

   :param pam: The presence-absence matrix to use for the computation.
   :type pam: Matrix

   :returns:

             A row of proportional range richness for the sites that each species in
                 the PAM is present.
   :rtype: Matrix


.. function:: schluter_species_variance_ratio(pam)

   Calculate Schluter's species variance ratio.

   :param pam: The presence-absence matrix to use for the computation.
   :type pam: Matrix

   :returns: The Schluter species variance ratio for the PAM.
   :rtype: float


.. function:: schluter_site_variance_ratio(pam)

   Calculate Schluter's site variance ratio.

   :param pam: The presence-absence matrix to use for the computation.
   :type pam: Matrix

   :returns: The Schluter site variance ratio for the PAM.
   :rtype: float


.. function:: num_sites(pam)

   Get the number of sites with presences.

   :param pam: The presence-absence matrix to use for the computation.
   :type pam: Matrix

   :returns: The number of sites that have present species.
   :rtype: int


.. function:: num_species(pam)

   Get the number of species with presences.

   :param pam: The presence-absence matrix to use for the computation.
   :type pam: Matrix

   :returns: The number of species that are present in at least one site.
   :rtype: int


.. function:: whittaker(pam)

   Calculate Whittaker's beta diversity metric for a PAM.

   :param pam: The presence-absence matrix to use for the computation.
   :type pam: Matrix

   :returns: Whittaker's beta diversity for the PAM.
   :rtype: float


.. function:: lande(pam)

   Calculate Lande's beta diversity metric for a PAM.

   :param pam: The presence-absence matrix to use for the computation.
   :type pam: Matrix

   :returns: Lande's beta diversity for the PAM.
   :rtype: float


.. function:: legendre(pam)

   Calculate Legendre's beta diversity metric for a PAM.

   :param pam: The presence-absence matrix to use for the computation.
   :type pam: Matrix

   :returns: Legendre's beta diversity for the PAM.
   :rtype: float


.. function:: c_score(pam)

   Calculate the checker board score for the PAM.

   :param pam: The presence-absence matrix to use for the computation.
   :type pam: Matrix

   :returns: The checkerboard score for the PAM.
   :rtype: float


.. function:: sigma_sites(pam)

   Compute the site sigma metric for a PAM.

   :param pam: The presence-absence matrix to use for the computation.
   :type pam: Matrix

   :returns: Matrix of covariance of composition of sites.
   :rtype: Matrix


.. function:: sigma_species(pam)

   Compute the species sigma metric for a PAM.

   :param pam: The presence-absence matrix to use for the computation.
   :type pam: Matrix

   :returns: Matrix of covariance of composition of species.
   :rtype: Matrix


.. function:: mean_nearest_taxon_distance(phylo_dist_mtx)

   Calculates the nearest neighbor distance.

   :param phylo_dist_mtx: A matrix of distances between the species present at a
                          site.
   :type phylo_dist_mtx: Matrix

   :returns: The average distance from each taxa to taxa nearest to it.
   :rtype: float


.. function:: mean_pairwise_distance(phylo_dist_mtx)

   Calculates mean pairwise distance between species present at a site.

   :param phylo_dist_mtx: A matrix of distances between the species present at a
                          site.
   :type phylo_dist_mtx: Matrix

   :returns: The average distance from each taxa all of the other co-located taxa.
   :rtype: float


.. function:: sum_pairwise_distance(phylo_dist_mtx)

   Calculates the sum pairwise distance for all species present at a site.

   :param phylo_dist_mtx: A matrix of distances between the species present at a
                          site.
   :type phylo_dist_mtx: Matrix

   :returns: The total distance from each taxa all of the other co-located taxa.
   :rtype: float


.. function:: pearson_correlation(pam, phylo_dist_mtx)

   Calculates the Pearson correlation coefficient for each site.

   :param pam: A presence-absence matrix to use for the computation.
   :type pam: Matrix
   :param phylo_dist_mtx: A matrix of distance between species.
   :type phylo_dist_mtx: Matrix

   :returns: A column of Pearson correlation values for each site in a PAM.
   :rtype: Matrix


.. function:: phylogenetic_diversity(tree)

   Calculate phylogenetic diversity of a tree.

   :param tree: A phylogenetic tree to compute phylogenetic diversity for.
   :type tree: TreeWrapper

   :returns: The sum of the edge lengths of the nodes of the provided tree.
   :rtype: float


.. class:: PamStats(pam, tree=None)


   Constructor for PAM stats computations.

   :param pam: A presence-absence matrix to use for computations.
   :type pam: Matrix
   :param tree: A tree to use for phylogenetic distance computations.
   :type tree: TreeWrapper

   .. attribute:: covariance_stats
      :annotation: = [None, None]

      

   .. attribute:: diversity_stats
      :annotation: = [None, None, None, None, None, None]

      

   .. attribute:: site_matrix_stats
      :annotation: = [None, None, None, None]

      

   .. attribute:: site_tree_stats
      :annotation: = [None]

      

   .. attribute:: site_tree_distance_matrix_stats
      :annotation: = [None, None, None]

      

   .. attribute:: site_pam_dist_mtx_stats
      :annotation: = [None]

      

   .. attribute:: species_matrix_stats
      :annotation: = [None, None, None, None]

      

   .. method:: calculate_covariance_statistics(self)

      Calculate covariance statistics matrices.

      :returns: A list of metric name, value tuples for covariance stats.
      :rtype: list of tuple


   .. method:: calculate_diversity_statistics(self)

      Calculate diversity statistics.

      :returns: A list of metric name, value tuples for diversity metrics.
      :rtype: list of tuple


   .. method:: calculate_site_statistics(self)

      Calculate site-based statistics.

      :returns: A matrix of site-based statistics for the selected metrics.
      :rtype: Matrix


   .. method:: calculate_species_statistics(self)

      Calculate species-based statistics.

      :returns: A matrix of species-based statistics for the selected metrics.
      :rtype: Matrix


   .. method:: register_metric(self, name, metric_function)

      Register a new metric.

      :param name: A name for this metric that will be used for a header.
      :type name: str
      :param metric_function: A decorated metric generating function.
      :type metric_function: function

      :raises TypeError: Raised if the metric function type cannot be processed.



