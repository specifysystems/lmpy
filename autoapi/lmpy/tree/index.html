

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>lmpy.tree &mdash; Lifemapper lmpy 3.0.0b1 documentation</title>
  

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/graphviz.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> Lifemapper lmpy
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../pages/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorial/tutorial.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../pages/about.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../pages/references.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../index.html">API Reference</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Lifemapper lmpy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li><code class="xref py py-mod docutils literal notranslate"><span class="pre">lmpy.tree</span></code></li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../../_sources/autoapi/lmpy/tree/index.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-lmpy.tree">
<span id="lmpy-tree"></span><h1><a class="reference internal" href="../../../source/lmpy.html#module-lmpy.tree" title="lmpy.tree"><code class="xref py py-mod docutils literal notranslate"><span class="pre">lmpy.tree</span></code></a><a class="headerlink" href="#module-lmpy.tree" title="Permalink to this headline">¶</a></h1>
<p>Module for the Lifemapper TreeWrapper class.</p>
<div class="section" id="module-contents">
<h2>Module Contents<a class="headerlink" href="#module-contents" title="Permalink to this headline">¶</a></h2>
<div class="section" id="classes">
<h3>Classes<a class="headerlink" href="#classes" title="Permalink to this headline">¶</a></h3>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="../../../source/lmpy.html#lmpy.tree.PhyloTreeKeys" title="lmpy.tree.PhyloTreeKeys"><code class="xref py py-obj docutils literal notranslate"><span class="pre">PhyloTreeKeys</span></code></a></p></td>
<td><p>Keys for phylogenetic trees.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../../../source/lmpy.html#lmpy.tree.TreeWrapper" title="lmpy.tree.TreeWrapper"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TreeWrapper</span></code></a></p></td>
<td><p>Dendropy Tree wrapper.</p></td>
</tr>
</tbody>
</table>
<dl class="py class">
<dt class="sig sig-object py" id="lmpy.tree.PhyloTreeKeys">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">lmpy.tree.</span></span><span class="sig-name descname"><span class="pre">PhyloTreeKeys</span></span><a class="reference internal" href="../../../_modules/lmpy/tree.html#PhyloTreeKeys"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmpy.tree.PhyloTreeKeys" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-obj docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Keys for phylogenetic trees.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="lmpy.tree.PhyloTreeKeys.MTX_IDX">
<span class="sig-name descname"><span class="pre">MTX_IDX</span></span><a class="reference internal" href="../../../_modules/lmpy/tree.html#PhyloTreeKeys.MTX_IDX"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmpy.tree.PhyloTreeKeys.MTX_IDX" title="Permalink to this definition">¶</a></dt>
<dd><p>The tree attribute indicating the matrix index position
for a node.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lmpy.tree.PhyloTreeKeys.SQUID">
<span class="sig-name descname"><span class="pre">SQUID</span></span><a class="reference internal" href="../../../_modules/lmpy/tree.html#PhyloTreeKeys.SQUID"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmpy.tree.PhyloTreeKeys.SQUID" title="Permalink to this definition">¶</a></dt>
<dd><p>The tree attribute indicating a hashed identifier for the
taxon.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id0">
<span class="sig-name descname"><span class="pre">MTX_IDX</span></span><em class="property"> <span class="pre">=</span> <span class="pre">mx</span></em><a class="reference internal" href="../../../_modules/lmpy/tree.html#PhyloTreeKeys.MTX_IDX"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id0" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id2">
<span class="sig-name descname"><span class="pre">SQUID</span></span><em class="property"> <span class="pre">=</span> <span class="pre">squid</span></em><a class="reference internal" href="../../../_modules/lmpy/tree.html#PhyloTreeKeys.SQUID"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="lmpy.tree.LmTreeException">
<em class="property"><span class="pre">exception</span> </em><span class="sig-prename descclassname"><span class="pre">lmpy.tree.</span></span><span class="sig-name descname"><span class="pre">LmTreeException</span></span><a class="reference internal" href="../../../_modules/lmpy/tree.html#LmTreeException"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmpy.tree.LmTreeException" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-obj docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>Wrapper around the base Exception class for tree related errors.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lmpy.tree.TreeWrapper">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">lmpy.tree.</span></span><span class="sig-name descname"><span class="pre">TreeWrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/lmpy/tree.html#TreeWrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmpy.tree.TreeWrapper" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-obj docutils literal notranslate"><span class="pre">dendropy.Tree</span></code></p>
<p>Dendropy Tree wrapper.</p>
<p>Dendropy tree wrapper that adds a little functionality and improves
performance of some functions.</p>
<dl class="py method">
<dt class="sig sig-object py" id="lmpy.tree.TreeWrapper.from_base_tree">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">from_base_tree</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cls</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tree</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/lmpy/tree.html#TreeWrapper.from_base_tree"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmpy.tree.TreeWrapper.from_base_tree" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a TreeWrapper object from a base dendropy.Tree.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>tree</strong> (<em>dendropy.Tree</em>) – A base dendropy tree object to wrap into a
TreeWrapper.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The newly wrapped tree.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="../../../source/lmpy.html#lmpy.tree.TreeWrapper" title="lmpy.tree.TreeWrapper">TreeWrapper</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmpy.tree.TreeWrapper.from_filename">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">from_filename</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cls</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/lmpy/tree.html#TreeWrapper.from_filename"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmpy.tree.TreeWrapper.from_filename" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a TreeWrapper object by loading a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>str</em>) – A file path to a tree file that should be loaded.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The newly loaded tree.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="../../../source/lmpy.html#lmpy.tree.TreeWrapper" title="lmpy.tree.TreeWrapper">TreeWrapper</a></p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>IOError</strong> – Raised if the tree file cannot be loaded based on the file
extension.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmpy.tree.TreeWrapper.add_node_labels">
<span class="sig-name descname"><span class="pre">add_node_labels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/lmpy/tree.html#TreeWrapper.add_node_labels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmpy.tree.TreeWrapper.add_node_labels" title="Permalink to this definition">¶</a></dt>
<dd><p>Add labels to the nodes in the tree.</p>
<p>Add labels to the unlabeled nodes in the tree.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prefix</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>, optional) – If provided, prefix the node labels
with this string.</p></li>
<li><p><strong>overwrite</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code>, optional) – Indicates whether existing node
labels should be overwritten or if they should be maintained.
Defaults to False.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>This labels nodes the way that R does.</p></li>
</ul>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmpy.tree.TreeWrapper.annotate_tree">
<span class="sig-name descname"><span class="pre">annotate_tree</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">annotation_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">annotation_attribute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_attribute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/lmpy/tree.html#TreeWrapper.annotate_tree"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmpy.tree.TreeWrapper.annotate_tree" title="Permalink to this definition">¶</a></dt>
<dd><p>Annotates tree tips and nodes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>annotation_dict</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code>) – A dictionary where the keys
correspond with the node labels and the value is either, a
single value, or a dictionary of annotation name keys and
annotation value values.</p></li>
<li><p><strong>annotation_attribute</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code> or None, optional) – Only used if
annotation_dict contains single values, this will be the name
of the annotation added for each node.  Using None or setting
value to ‘label’ will change the label of the node.  Defaults
to None.</p></li>
<li><p><strong>label_attribute</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>, optional) – Use the value of this
annotation as the label for the node.  Setting the value to
‘label’ or leaving as None will use the label of the node.
Defaults to None.</p></li>
<li><p><strong>update</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code>, optional) – If True, update any existing
annotations with the annotations provided.  Defaults to False.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmpy.tree.TreeWrapper.annotate_tree_tips">
<span class="sig-name descname"><span class="pre">annotate_tree_tips</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attribute_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">annotation_pairs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_attribute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'label'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/lmpy/tree.html#TreeWrapper.annotate_tree_tips"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmpy.tree.TreeWrapper.annotate_tree_tips" title="Permalink to this definition">¶</a></dt>
<dd><p>Annotates the tips of the tree.</p>
<dl class="simple">
<dt>Deprecated:</dt><dd><p>Update to use annotate_tree.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>attribute_name</strong> (<em>str</em>) – The name of the annotation attribute to add.</p></li>
<li><p><strong>annotation_pairs</strong> (<em>dict</em>) – A dictionary of label keys with annotation values.</p></li>
<li><p><strong>label_attribute</strong> (<em>str</em><em>, </em><em>optional</em>) – If this is provided, use this annotation
attribute as the key instead of the label. Defaults to ‘label’.</p></li>
<li><p><strong>update</strong> (<em>bool</em><em>, </em><em>optional</em>) – Defaults to False.  Indicates if existing
annotations should be updated.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmpy.tree.TreeWrapper.get_annotations">
<span class="sig-name descname"><span class="pre">get_annotations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">annotation_attribute</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/lmpy/tree.html#TreeWrapper.get_annotations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmpy.tree.TreeWrapper.get_annotations" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets a list of (label, annotation) pairs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>annotation_attribute</strong> (<em>str</em>) – The annotation attribute to retrieve.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A list of annotations.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmpy.tree.TreeWrapper.get_distance_matrix">
<span class="sig-name descname"><span class="pre">get_distance_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_attribute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'label'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ordered_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/lmpy/tree.html#TreeWrapper.get_distance_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmpy.tree.TreeWrapper.get_distance_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets a Matrix object of phylogenetic distances.</p>
<p>Get a Matrix object of phylogenetic distances between tips using a
lower memory footprint.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>label_attribute</strong> (<em>str</em><em>, </em><em>optional</em>) – The attribute of the tips to use as labels
for the matrix.  Defaults to ‘label’.</p></li>
<li><p><strong>ordered_labels</strong> (<em>list of str</em><em>, </em><em>optional</em>) – If provided, use this order of
labels.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>A distance matrix from each tip to each of the other tips</dt><dd><p>in the tree.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="../../../source/lmpy.html#lmpy.matrix.Matrix" title="lmpy.matrix.Matrix">Matrix</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmpy.tree.TreeWrapper.get_distance_matrix_dendropy">
<span class="sig-name descname"><span class="pre">get_distance_matrix_dendropy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_attribute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'label'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ordered_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/lmpy/tree.html#TreeWrapper.get_distance_matrix_dendropy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmpy.tree.TreeWrapper.get_distance_matrix_dendropy" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets a Matrix object of phylogenetic distances between tips.</p>
<p>Gets the distance matrix between each tip using Dendropy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>label_attribute</strong> (<em>str</em><em>, </em><em>optional</em>) – The attribute of the tips to use as labels
for the matrix.  Defaults to ‘label’.</p></li>
<li><p><strong>ordered_labels</strong> (<em>list of str</em><em>, </em><em>optional</em>) – If provided, use this order of
labels.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<dl class="simple">
<dt>This method may require a significant amount of memory for large trees.</dt><dd><p>The <cite>get_distance_matrix</cite> method has a smaller memory footprint and
works at nearly the same speed.</p>
</dd>
</dl>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><dl class="simple">
<dt>A distance matrix from each tip to each of the other tips in the</dt><dd><p>tree.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="../../../source/lmpy.html#lmpy.matrix.Matrix" title="lmpy.matrix.Matrix">Matrix</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmpy.tree.TreeWrapper.get_labels">
<span class="sig-name descname"><span class="pre">get_labels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/lmpy/tree.html#TreeWrapper.get_labels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmpy.tree.TreeWrapper.get_labels" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets tip labels for a clade.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Bottom-up order.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A list of taxon labels for the taxa in the tree.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmpy.tree.TreeWrapper.get_variance_covariance_matrix">
<span class="sig-name descname"><span class="pre">get_variance_covariance_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_attribute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'label'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ordered_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/lmpy/tree.html#TreeWrapper.get_variance_covariance_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmpy.tree.TreeWrapper.get_variance_covariance_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets a Matrix object of variance / co-variance for tips in tree.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>label_attribute</strong> (<em>str</em><em>, </em><em>optional</em>) – The attribute of the tips to use as labels
for the matrix.  Defaults to ‘label’.</p></li>
<li><p><strong>ordered_labels</strong> (<em>list of str</em><em>, </em><em>optional</em>) – If provided, use this order of
labels.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>A matrix of variance / co-variance values for the tips in</dt><dd><p>the tree.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="../../../source/lmpy.html#lmpy.matrix.Matrix" title="lmpy.matrix.Matrix">Matrix</a></p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference internal" href="../../../source/lmpy.html#lmpy.tree.LmTreeException" title="lmpy.tree.LmTreeException"><strong>LmTreeException</strong></a> – If the tree does not have branch lengths.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmpy.tree.TreeWrapper.has_branch_lengths">
<span class="sig-name descname"><span class="pre">has_branch_lengths</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/lmpy/tree.html#TreeWrapper.has_branch_lengths"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmpy.tree.TreeWrapper.has_branch_lengths" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a boolean indicating if the entire tree has branch lengths.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>An indication if the tree has branch lengths.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmpy.tree.TreeWrapper.has_polytomies">
<span class="sig-name descname"><span class="pre">has_polytomies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/lmpy/tree.html#TreeWrapper.has_polytomies"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmpy.tree.TreeWrapper.has_polytomies" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns boolean indicating if the tree has polytomies.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>An indication if the tree has any polytomies.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmpy.tree.TreeWrapper.is_binary">
<span class="sig-name descname"><span class="pre">is_binary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/lmpy/tree.html#TreeWrapper.is_binary"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmpy.tree.TreeWrapper.is_binary" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks if the tree is binary.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>An indication if the tree is binary.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Checks that every clade has either zero or two children.</p></li>
</ul>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmpy.tree.TreeWrapper.is_ultrametric">
<span class="sig-name descname"><span class="pre">is_ultrametric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rel_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/lmpy/tree.html#TreeWrapper.is_ultrametric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmpy.tree.TreeWrapper.is_ultrametric" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks if the tree is ultrametric.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>rel_tol</strong> (<em>float</em>) – The relative tolerance to determine if the min and
max are equal.  We will say they are equal if they are 99.9%.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>Returns true if the distance from the root to each tip is the</dt><dd><p>same (within the tolerance interval).</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><dl class="simple">
<dt>To be ultrametric, the branch length from root to tip must be</dt><dd><p>equal for all tips.</p>
</dd>
</dl>
</li>
</ul>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmpy.tree.TreeWrapper.prune_tips_without_attribute">
<span class="sig-name descname"><span class="pre">prune_tips_without_attribute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">search_attribute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">PhyloTreeKeys.MTX_IDX</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/lmpy/tree.html#TreeWrapper.prune_tips_without_attribute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmpy.tree.TreeWrapper.prune_tips_without_attribute" title="Permalink to this definition">¶</a></dt>
<dd><p>Prunes the tree of any tips that don’t have the specified attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>search_attribute</strong> (<em>str</em><em>, </em><em>optional</em>) – The attribute to look for when pruning
tips in the tree.  Defaults to PhyloTreeKeys.MTX_IDX.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmpy.tree.TreeWrapper._annotation_method">
<span class="sig-name descname"><span class="pre">_annotation_method</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_attribute</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/lmpy/tree.html#TreeWrapper._annotation_method"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmpy.tree.TreeWrapper._annotation_method" title="Permalink to this definition">¶</a></dt>
<dd><p>Use the label attribute as the node label.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>label_attribute</strong> (<em>str</em>) – The annotation to use as the label for the
nodes in the tree.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A method for retrieving the label for a taxon.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Method</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmpy.tree.TreeWrapper._annotate_node">
<span class="sig-name descname"><span class="pre">_annotate_node</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">annotation_attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">annotation_value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/lmpy/tree.html#TreeWrapper._annotate_node"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmpy.tree.TreeWrapper._annotate_node" title="Permalink to this definition">¶</a></dt>
<dd><p>Annotates a node with the given value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>node</strong> (<em>Node</em>) – A node to add an annotation to.</p></li>
<li><p><strong>annotation_attribute</strong> (<em>str</em>) – The annotation attribute to add.  If
None or ‘label’, update the node label.</p></li>
<li><p><strong>annotation_value</strong> – The value of the annotation.</p></li>
<li><p><strong>update</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, update existing attribute.
Defaults to False.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmpy.tree.TreeWrapper._get_label_method">
<span class="sig-name descname"><span class="pre">_get_label_method</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_attribute</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/lmpy/tree.html#TreeWrapper._get_label_method"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmpy.tree.TreeWrapper._get_label_method" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the function to be used for retrieving labels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>label_attribute</strong> (<em>str</em>) – An annotation name, ‘label’, or None used to
determine which method to use to retrieve the label of a node.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Function for labeling nodes.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmpy.tree.TreeWrapper._label_tree_nodes">
<span class="sig-name descname"><span class="pre">_label_tree_nodes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/lmpy/tree.html#TreeWrapper._label_tree_nodes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmpy.tree.TreeWrapper._label_tree_nodes" title="Permalink to this definition">¶</a></dt>
<dd><p>Private function to do the work when labeling nodes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>node</strong> (<em>Node</em>) – A node to label.</p></li>
<li><p><strong>i</strong> (<em>int</em>) – A count of the number of previously labeled nodes.</p></li>
<li><p><strong>prefix</strong> (<em>str</em><em>, </em><em>optional</em>) – A prefix to use when labeling nodes resulting in
labels like ‘prefix_0’.  Defaults to None and no prefix.</p></li>
<li><p><strong>overwrite</strong> (<em>bool</em><em>, </em><em>optional</em>) – Should node labels be overwritten.  Defaults to
False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The number of nodes already labeled in the tree.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Recursive.</p></li>
</ul>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmpy.tree.TreeWrapper._label_method">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">_label_method</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/lmpy/tree.html#TreeWrapper._label_method"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmpy.tree.TreeWrapper._label_method" title="Permalink to this definition">¶</a></dt>
<dd><p>Use the label of the node or taxon for the label.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>node</strong> (<em>Node</em>) – The node to get the label for.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>If the node or the node’s taxon has a label, return it.
None: If the node and it’s taxon do not have labels.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
</div>
</div>


           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Lifemapper Team.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>